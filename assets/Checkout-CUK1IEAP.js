import{c as De,s as D,i as ae,z as ee,r as c,j as e,T as he,B as te,M as Le,E as qe,g as y,S as Z,L as G,X as Be,k as W,w as Pe,F as Oe,G as Ue,A as ze,H as Ye,I as We,p as Xe}from"./index-BwKEMP-W.js";import{I as Q,L as se}from"./label-V6Maqap_.js";import{T as Ge}from"./trash-2-DVHvuucu.js";import{C as Qe,a as U,S as Se,b as Ie,c as Ee,d as ke,e as _e,f as Je,U as ge,F as He,I as Ze,M as Ke}from"./select-CmxT957_.js";import{C as et}from"./chevron-down-CVASKbkn.js";import{M as Me,P as Ve,C as tt}from"./phone-DU50vvV-.js";import{U as Fe}from"./user-C8fTgGSI.js";import{T as st}from"./truck-DP_YsrUT.js";import{C as xe,a as ce}from"./credit-card-511HckFY.js";import{L as Re}from"./loader-circle-cLNfqVl6.js";import{P as Ae}from"./package-BnuK6_gU.js";import{C as rt}from"./circle-alert-VgjotBQ7.js";import{C as at}from"./circle-check-BRq-rAxU.js";import{S as nt}from"./shopping-bag-Cz2DUBXx.js";import{C as fe}from"./chevron-left-DPeI3kg5.js";import"./index-BYr2kbx-.js";/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Te=De("Lock",[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 10 0v4",key:"fwvmzm"}]]),de=s=>{const t=s.replace(/\D/g,"");if(t.length!==11||/^(\d)\1+$/.test(t))return!1;let n=0;for(let a=0;a<9;a++)n+=parseInt(t.charAt(a))*(10-a);let i=n*10%11;if((i===10||i===11)&&(i=0),i!==parseInt(t.charAt(9)))return!1;n=0;for(let a=0;a<10;a++)n+=parseInt(t.charAt(a))*(11-a);return i=n*10%11,(i===10||i===11)&&(i=0),i===parseInt(t.charAt(10))},me=s=>/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(s),ue=s=>{const t=s.replace(/\D/g,"");return t.length>=10&&t.length<=11},be=s=>s.replace(/\D/g,"").length===8,ot=s=>s.replace(/\D/g,"").slice(0,11).replace(/(\d{3})(\d)/,"$1.$2").replace(/(\d{3})(\d)/,"$1.$2").replace(/(\d{3})(\d{1,2})$/,"$1-$2"),it=s=>{const t=s.replace(/\D/g,"").slice(0,11);return t.length<=10?t.replace(/(\d{2})(\d)/,"($1) $2").replace(/(\d{4})(\d)/,"$1-$2"):t.replace(/(\d{2})(\d)/,"($1) $2").replace(/(\d{5})(\d)/,"$1-$2")},ct=s=>s.replace(/\D/g,"").slice(0,8).replace(/(\d{5})(\d)/,"$1-$2"),X=s=>new Intl.NumberFormat("pt-BR",{style:"currency",currency:"BRL"}).format(s),lt=async s=>{const t=s.replace(/\D/g,"");if(t.length!==8)return null;const n=D.functions.invoke("cep-lookup",{body:{cep:t}}).then(({data:a,error:m})=>{if(!m&&a&&!a.error)return a;throw new Error("backend failed")}),i=fetch(`https://viacep.com.br/ws/${t}/json/`).then(a=>{if(!a.ok)throw new Error("viacep http error");return a.json()}).then(a=>{if(a.erro)throw new Error("cep not found");return a});try{return await new Promise((m,d)=>{let I=0;const r=()=>{++I===2&&d(new Error("all failed"))};n.then(m).catch(r),i.then(m).catch(r)})}catch{return null}},dt=["AC","AL","AP","AM","BA","CE","DF","ES","GO","MA","MT","MS","MG","PA","PB","PR","PE","PI","RJ","RN","RS","RO","RR","SC","SP","SE","TO"],re=10,je=({className:s,isMobile:t=!1})=>{const{items:n,totalPrice:i,updateQuantity:a,removeFromCart:m}=ae(),{shippingCost:d,couponCode:I,couponDiscount:r,applyCoupon:j,removeCoupon:l,isSummaryCollapsed:C,paymentMethod:g}=ee(),[_,w]=c.useState(""),[x,p]=c.useState(""),[v,h]=c.useState(!1);c.useEffect(()=>{C&&h(!1)},[C]);const N=()=>{if(p(""),!_.trim()){p("Digite um cupom");return}j(_)?w(""):p("Cupom inv√°lido")},E=i*r/100,k=g==="pix"?i*re/100:0,V=i+d-E-k,S=e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"mb-3",children:[I?e.jsxs("div",{className:"flex items-center justify-between bg-primary/10 p-1.5 rounded",children:[e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(he,{className:"w-2.5 h-2.5 text-primary"}),e.jsx("span",{className:"text-[10px] font-medium text-primary",children:I}),e.jsxs("span",{className:"text-[9px] text-muted-foreground",children:["(-",r,"%)"]})]}),e.jsx("button",{onClick:l,className:"text-[9px] text-destructive hover:underline",children:"Remover"})]}):e.jsxs("div",{className:"flex gap-1",children:[e.jsx(Q,{placeholder:"CUPOM",value:_,onChange:u=>w(u.target.value.toUpperCase()),className:"flex-1 text-[10px] uppercase h-7 px-2"}),e.jsx(te,{variant:"outline",size:"sm",onClick:N,className:"text-[10px] text-primary border-primary hover:bg-primary hover:text-primary-foreground h-7 px-2",children:"Aplicar"})]}),x&&e.jsx("p",{className:"text-[9px] text-destructive mt-0.5",children:x})]}),e.jsx("div",{className:"space-y-2 mb-3 max-h-48 overflow-y-auto",children:n.map(u=>e.jsxs("div",{className:"flex gap-2",children:[e.jsx("img",{src:u.product.image,alt:u.product.name,className:"w-12 h-14 object-cover rounded bg-muted flex-shrink-0"}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("p",{className:"text-[11px] font-medium text-foreground line-clamp-2 leading-tight",children:u.product.name}),u.size&&e.jsxs("p",{className:"text-[9px] text-muted-foreground",children:["Tam: ",e.jsx("span",{className:"font-medium text-foreground",children:u.size})]}),e.jsx("p",{className:"text-[11px] font-semibold text-[#22c55e]",children:X(u.product.price*u.quantity)}),e.jsxs("div",{className:"flex items-center gap-1.5 mt-1",children:[e.jsxs("div",{className:"flex items-center border border-border rounded overflow-hidden",children:[e.jsx("button",{onClick:()=>a(u.product.id,u.quantity-1,u.size),className:"w-5 h-5 flex items-center justify-center hover:bg-muted transition-colors",children:e.jsx(Le,{className:"w-2.5 h-2.5"})}),e.jsx("span",{className:"w-5 h-5 flex items-center justify-center text-[10px] font-medium",children:u.quantity}),e.jsx("button",{onClick:()=>a(u.product.id,u.quantity+1,u.size),className:"w-5 h-5 flex items-center justify-center hover:bg-muted transition-colors",children:e.jsx(qe,{className:"w-2.5 h-2.5"})})]}),e.jsx("button",{onClick:()=>m(u.product.id,u.size),className:"w-5 h-5 flex items-center justify-center text-muted-foreground hover:text-destructive transition-colors",children:e.jsx(Ge,{className:"w-2.5 h-2.5"})})]})]})]},`${u.product.id}-${u.size||"no-size"}`))}),e.jsx("div",{className:"border-t border-border my-2"}),e.jsxs("div",{className:"space-y-1",children:[e.jsxs("div",{className:"flex justify-between text-[11px]",children:[e.jsx("span",{className:"text-muted-foreground",children:"Subtotal"}),e.jsx("span",{className:"text-foreground",children:X(i)})]}),E>0&&e.jsxs("div",{className:"flex justify-between text-[11px] bg-primary/10 -mx-1.5 px-1.5 py-1 rounded",children:[e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(he,{className:"w-2.5 h-2.5 text-primary"}),e.jsxs("span",{className:"text-primary font-medium",children:["Cupom ",I]})]}),e.jsxs("span",{className:"text-primary font-medium",children:["-",X(E)]})]}),k>0&&e.jsxs("div",{className:"flex justify-between text-[11px] bg-green-50 dark:bg-green-900/20 -mx-1.5 px-1.5 py-1 rounded",children:[e.jsx("div",{className:"flex items-center gap-1",children:e.jsxs("span",{className:"text-green-600 dark:text-green-400 font-medium",children:["Desconto PIX (",re,"%)"]})}),e.jsxs("span",{className:"text-green-600 dark:text-green-400 font-medium",children:["-",X(k)]})]}),e.jsx("div",{className:"border-t border-border my-2"}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-sm font-semibold text-foreground",children:"Total"}),e.jsx("span",{className:"text-base font-bold text-[#22c55e]",children:X(V)})]})]})]});return t?e.jsxs("div",{className:y("bg-card rounded-lg border border-border shadow-sm",s),children:[e.jsxs("button",{onClick:()=>h(!v),className:"w-full flex items-center justify-between p-3",children:[e.jsx("span",{className:"text-sm font-semibold text-foreground",children:"Resumo"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-sm font-bold text-[#22c55e]",children:X(V)}),v?e.jsx(Qe,{className:"w-4 h-4 text-muted-foreground"}):e.jsx(et,{className:"w-4 h-4 text-muted-foreground"})]})]}),v&&e.jsx("div",{className:"px-3 pb-3",children:S})]}):e.jsxs("div",{className:y("bg-card rounded-lg border border-border shadow-sm p-4",s),children:[e.jsx("h2",{className:"text-sm font-semibold text-foreground mb-3",children:"Resumo"}),S]})},mt="/assets/payment-methods-BZHzOAxQ.png",oe=()=>e.jsx("footer",{className:"mt-8 py-6 border-t border-gray-200 bg-white",children:e.jsxs("div",{className:"max-w-lg mx-auto px-4",children:[e.jsx("div",{className:"flex items-center justify-center gap-2 mb-4",children:e.jsxs("div",{className:"flex items-center gap-1.5 bg-gray-100 text-gray-900 px-3 py-1.5 rounded-full",children:[e.jsx(Te,{className:"w-3.5 h-3.5"}),e.jsx("span",{className:"text-xs font-semibold",children:"100% SEGURO"})]})}),e.jsx("div",{className:"flex items-center justify-center mb-4",children:e.jsx("img",{src:mt,alt:"Formas de pagamento: Pix, Boleto, Visa, Mastercard, Hipercard, Cielo, American Express, Diners Club, Discover, Elo",className:"h-auto max-h-16 w-auto max-w-full object-contain"})}),e.jsxs("div",{className:"text-center space-y-1.5 text-[10px] text-gray-600",children:[e.jsx("p",{className:"font-medium",children:"VYRON LTDA"}),e.jsxs("div",{className:"flex items-center justify-center gap-3 pt-1",children:[e.jsxs("a",{href:"mailto:contato@vyron.com.br",className:"flex items-center gap-1 hover:text-gray-900 transition-colors",children:[e.jsx(Me,{className:"w-3 h-3"}),"suporte@usevyron.com"]}),e.jsxs("a",{href:"tel:0800123456",className:"flex items-center gap-1 hover:text-gray-900 transition-colors",children:[e.jsx(Ve,{className:"w-3 h-3"}),"0800 123 456"]})]})]}),e.jsxs("div",{className:"flex items-center justify-center gap-3 mt-4",children:[e.jsx("img",{src:"https://res.cloudinary.com/beleza-na-web/image/upload/f_svg,fl_progressive,q_auto:eco/v1/blz/assets-store/0.0.548/images/icons/security-100.svg",alt:"Site Seguro",className:"h-6 w-auto opacity-80"}),e.jsx("img",{src:"https://res.cloudinary.com/beleza-na-web/image/upload/f_svg,fl_progressive,q_auto:eco/v1/blz/assets-store/0.0.548/images/icons/security-google-icon.svg",alt:"Google Safe",className:"h-6 w-auto opacity-80"})]})]})}),Ne=[{id:1,label:"Dados",icon:Fe},{id:2,label:"Entrega",icon:st},{id:3,label:"Pagamento",icon:xe}],ut=({currentStep:s})=>e.jsx("div",{className:"w-full py-1.5 px-3",children:e.jsx("div",{className:"flex items-center justify-center max-w-xs mx-auto",children:Ne.map((t,n)=>{const i=s>t.id,a=s===t.id,m=t.icon;return e.jsxs("div",{className:"flex items-center",children:[e.jsxs("div",{className:"flex flex-col items-center",children:[e.jsx("div",{className:y("w-7 h-7 rounded-full flex items-center justify-center transition-all duration-300",i&&"bg-white text-black",a&&"bg-white text-black shadow-sm ring-2 ring-gray-500",!i&&!a&&"bg-gray-700 text-gray-400 border border-gray-500"),children:i?e.jsx(U,{className:"w-3 h-3",strokeWidth:2.5}):e.jsx(m,{className:"w-3 h-3",strokeWidth:a?2.5:2})}),e.jsx("span",{className:y("mt-1 text-[9px] font-medium transition-colors",i&&"text-white",a&&"text-white font-semibold",!i&&!a&&"text-gray-500"),children:t.label})]}),n<Ne.length-1&&e.jsx("div",{className:"flex items-center h-7 mx-3",children:e.jsx("div",{className:y("w-8 h-px rounded-full transition-all duration-300",s>t.id?"bg-white":"bg-gray-600")})})]},t.id)})})}),xt=()=>{let s=sessionStorage.getItem("presence_session_id");return s||(s=crypto.randomUUID(),sessionStorage.setItem("presence_session_id",s)),s},ve=()=>{const s=new URLSearchParams(window.location.search),t=sessionStorage.getItem("utm_params"),n=t?JSON.parse(t):{};return{utm_source:s.get("utm_source")||n.utm_source||null,utm_medium:s.get("utm_medium")||n.utm_medium||null,utm_campaign:s.get("utm_campaign")||n.utm_campaign||null,utm_content:s.get("utm_content")||n.utm_content||null,utm_term:s.get("utm_term")||n.utm_term||null}},pt=async(s,t)=>{try{const n=new Date().toISOString().split("T")[0],i=`checkout_${t}`,{data:a}=await D.from("session_page_tracking").select("id").eq("date",n).eq("page_type",i).eq("session_id",s).maybeSingle();if(a)return;const{error:m}=await D.from("session_page_tracking").insert({date:n,page_type:i,session_id:s});if(m&&!m.message.includes("duplicate")){console.error("Error tracking checkout step:",m);return}const{data:d}=await D.from("daily_page_stats").select("id, unique_sessions, total_views").eq("date",n).eq("page_type",i).maybeSingle();d?await D.from("daily_page_stats").update({unique_sessions:d.unique_sessions+1,total_views:d.total_views+1}).eq("id",d.id):await D.from("daily_page_stats").insert({date:n,page_type:i,unique_sessions:1,total_views:1})}catch(n){console.error("Error tracking checkout step stat:",n)}},pe=()=>{const{items:s,totalPrice:t}=ae(),n=c.useRef(xt()),i=c.useRef(null),a=c.useRef(new Set);c.useEffect(()=>{const r=ve();(r.utm_source||r.utm_medium||r.utm_campaign)&&sessionStorage.setItem("utm_params",JSON.stringify(r))},[]);const m=c.useCallback(async(r,j,l)=>{l&&!a.current.has(l)&&(a.current.add(l),pt(n.current,l));const C=(r==null?void 0:r.firstName)||(r==null?void 0:r.email)||(r==null?void 0:r.phone),g=j==null?void 0:j.cep;if(!C&&!g)return;const _=ve();try{const{data:w}=await D.from("abandoned_carts").select("id").eq("session_id",n.current).maybeSingle(),x={session_id:n.current,customer_name:r!=null&&r.firstName&&(r!=null&&r.lastName)?`${r.firstName} ${r.lastName}`.trim():(r==null?void 0:r.firstName)||null,customer_email:(r==null?void 0:r.email)||null,customer_phone:(r==null?void 0:r.phone)||null,cep:(j==null?void 0:j.cep)||null,cart_items:s.map(p=>{var v;return{id:p.product.id,name:p.product.name,price:p.product.price,quantity:p.quantity,image:((v=p.product.images)==null?void 0:v[0])||p.product.image}}),cart_total:Math.round(t*100),last_step:l||"dados",updated_at:new Date().toISOString(),..._};w?await D.from("abandoned_carts").update(x).eq("session_id",n.current):await D.from("abandoned_carts").insert(x)}catch(w){console.error("Error saving abandoned cart:",w)}},[s,t]),d=c.useCallback((r,j,l)=>{i.current&&clearTimeout(i.current),i.current=window.setTimeout(()=>{m(r,j,l)},1500)},[m]),I=c.useCallback(async()=>{try{await D.from("abandoned_carts").delete().eq("session_id",n.current)}catch(r){console.error("Error clearing abandoned cart:",r)}},[]);return c.useEffect(()=>()=>{i.current&&clearTimeout(i.current)},[]),{saveAbandonedCart:d,clearAbandonedCart:I}},ne=({id:s,label:t,value:n,onChange:i,onBlur:a,error:m,touched:d,type:I="text",inputMode:r,maxLength:j,helperText:l,isValid:C})=>e.jsxs("div",{className:"space-y-1",children:[e.jsxs("div",{className:"relative",children:[e.jsx(Q,{id:s,type:I,inputMode:r,placeholder:" ",value:n,onChange:g=>i(g.target.value),onBlur:a,maxLength:j,className:y("h-12 pt-4 pb-1.5 text-sm rounded-xl border bg-card peer transition-all px-3.5 pr-9 shadow-sm",d&&m?"border-destructive focus-visible:border-destructive":"border-muted-foreground/20 focus-visible:border-primary")}),e.jsx("label",{htmlFor:s,className:y("absolute left-3.5 transition-all duration-200 pointer-events-none text-sm","peer-placeholder-shown:top-1/2 peer-placeholder-shown:-translate-y-1/2 peer-placeholder-shown:text-sm","peer-focus:top-1.5 peer-focus:-translate-y-0 peer-focus:text-[10px]",n?"top-1.5 -translate-y-0 text-[10px]":"",d&&m?"text-destructive":"text-muted-foreground"),children:t}),d&&!m&&C&&e.jsx("div",{className:"absolute right-3.5 top-1/2 -translate-y-1/2",children:e.jsx(U,{className:"w-3.5 h-3.5 text-accent"})})]}),d&&m&&e.jsx("p",{className:"text-destructive text-[11px] pl-1",children:m}),l&&!m&&e.jsx("p",{className:"text-muted-foreground text-[11px] pl-1",children:l})]}),ye=()=>{const{customerData:s,setCustomerData:t,nextStep:n}=ee(),{saveAbandonedCart:i}=pe();c.useEffect(()=>{window.scrollTo({top:0,behavior:"smooth"})},[]);const[a,m]=c.useState({email:s.email,fullName:`${s.firstName} ${s.lastName}`.trim(),cpf:s.cpf,phone:s.phone,wantsPromos:s.wantsPromos}),[d,I]=c.useState({}),[r,j]=c.useState({}),l=(x,p)=>{switch(x){case"email":if(!p.trim())return"E-mail √© obrigat√≥rio";if(!me(p))return"Digite um e-mail v√°lido";break;case"fullName":if(!p.trim())return"Nome completo √© obrigat√≥rio";if(p.trim().split(" ").length<2)return"Digite nome e sobrenome";break;case"cpf":if(!p.trim())return"CPF √© obrigat√≥rio";if(!de(p))return"CPF deve ter 11 d√≠gitos v√°lidos";break;case"phone":if(!p.trim())return"Telefone √© obrigat√≥rio";if(!ue(p))return"Digite um telefone v√°lido com DDD";break}},C=(x,p)=>{let v=p;x==="cpf"&&typeof p=="string"?v=ot(p):x==="phone"&&typeof p=="string"&&(v=it(p));const h={...a,[x]:v};m(h),x==="email"&&typeof v=="string"&&i({...s,...h,email:v},void 0,"dados"),d[x]&&I(N=>({...N,[x]:void 0}))},g=x=>{j(v=>({...v,[x]:!0}));const p=l(x,a[x]);I(v=>({...v,[x]:p}))},_=me(a.email)&&a.fullName.trim().split(" ").length>=2&&de(a.cpf)&&ue(a.phone),w=x=>{x.preventDefault();const p=["email","fullName","cpf","phone"];let v=!0;const h={};if(p.forEach(N=>{const E=l(N,a[N]);E&&(h[N]=E,v=!1)}),I(h),j({email:!0,fullName:!0,cpf:!0,phone:!0}),v){const N=a.fullName.trim().split(" "),E=N[0],k=N.slice(1).join(" ");t({...s,email:a.email,firstName:E,lastName:k,cpf:a.cpf,phone:a.phone,wantsPromos:a.wantsPromos}),n()}};return e.jsxs("div",{className:"w-full lg:max-w-lg lg:mx-auto space-y-4",children:[e.jsxs("div",{className:"text-left space-y-0.5",children:[e.jsx("h1",{className:"text-sm font-semibold text-foreground",children:"Dados pessoais"}),e.jsx("p",{className:"text-[11px] text-muted-foreground",children:"Pedimos apenas as informa√ß√µes essenciais para concluir sua compra com seguran√ßa."})]}),e.jsxs("form",{onSubmit:w,className:"space-y-3",children:[e.jsx(ne,{id:"email",label:"E-mail",type:"email",inputMode:"email",value:a.email,onChange:x=>C("email",x),onBlur:()=>g("email"),error:d.email,touched:r.email,isValid:me(a.email),helperText:"Para confirma√ß√£o e rastreio"}),e.jsx(ne,{id:"fullName",label:"Nome completo",value:a.fullName,onChange:x=>C("fullName",x),onBlur:()=>g("fullName"),error:d.fullName,touched:r.fullName,isValid:a.fullName.trim().split(" ").length>=2}),e.jsx(ne,{id:"cpf",label:"CPF",inputMode:"numeric",maxLength:14,value:a.cpf,onChange:x=>C("cpf",x),onBlur:()=>g("cpf"),error:d.cpf,touched:r.cpf,isValid:de(a.cpf),helperText:"Impress√£o da nota fiscal"}),e.jsx(ne,{id:"phone",label:"Celular com DDD",type:"tel",inputMode:"numeric",maxLength:15,value:a.phone,onChange:x=>C("phone",x),onBlur:()=>g("phone"),error:d.phone,touched:r.phone,isValid:ue(a.phone)}),e.jsxs(te,{type:"submit",disabled:!_,className:y("w-full h-12 mt-2 font-semibold rounded-full text-sm flex items-center justify-center gap-1.5 transition-all",_?"bg-[#141414] hover:bg-[#2a2a2a] text-white shadow-md":"bg-muted text-muted-foreground"),children:["Continuar",e.jsx(ce,{className:"w-4 h-4"})]}),e.jsx("p",{className:"text-[11px] text-muted-foreground text-center pt-1.5",children:"Dados seguros e protegidos"})]})]})},Y=({id:s,label:t,value:n,onChange:i,onBlur:a,error:m,touched:d,type:I="text",inputMode:r,maxLength:j,isValid:l,optional:C})=>e.jsxs("div",{className:"space-y-1",children:[e.jsxs("div",{className:"relative",children:[e.jsx(Q,{id:s,type:I,inputMode:r,placeholder:" ",value:n,onChange:g=>i(g.target.value),onBlur:a,maxLength:j,className:y("h-14 px-4 pt-5 pb-2 pr-10 text-base rounded-xl border bg-card peer transition-all shadow-sm",d&&m?"border-destructive":"border-muted-foreground/20 focus-visible:border-primary")}),e.jsxs("label",{htmlFor:s,className:y("absolute left-4 transition-all duration-200 pointer-events-none text-base","peer-placeholder-shown:top-1/2 peer-placeholder-shown:-translate-y-1/2 peer-placeholder-shown:text-base","peer-focus:top-2 peer-focus:-translate-y-0 peer-focus:text-xs",n?"top-2 -translate-y-0 text-xs":"",d&&m?"text-destructive":"text-muted-foreground"),children:[t," ",C&&e.jsx("span",{className:"text-muted-foreground/60",children:"(opcional)"})]}),d&&!m&&l&&e.jsx("div",{className:"absolute right-4 top-1/2 -translate-y-1/2",children:e.jsx(U,{className:"w-4 h-4 text-accent"})})]}),d&&m&&e.jsx("p",{className:"text-destructive text-xs pl-1",children:m})]}),ht=()=>{const{customerData:s,addressData:t,setAddressData:n,shippingOption:i,setShippingOption:a,nextStep:m}=ee(),{saveAbandonedCart:d}=pe();c.useEffect(()=>{window.scrollTo({top:0,behavior:"smooth"})},[]);const I=`${s.firstName} ${s.lastName}`.trim(),[r,j]=c.useState({cep:t.cep,street:t.street,number:t.number,complement:t.complement,neighborhood:t.neighborhood,city:t.city,state:t.state,recipient:t.recipient||I,shippingMethod:i==="express"?"express":"normal"}),[l,C]=c.useState({}),[g,_]=c.useState({}),[w,x]=c.useState(!1),[p,v]=c.useState(!!t.street),[h,N]=c.useState(!1),[E,k]=c.useState(!1),V=c.useRef(null),S=E||h,u=(o,f)=>{switch(o){case"cep":if(!f.trim())return"CEP √© obrigat√≥rio";if(!be(f))return"CEP deve ter 8 d√≠gitos";break;case"number":if(!f.trim())return"N√∫mero √© obrigat√≥rio";break;case"recipient":if(!f.trim())return"Destinat√°rio √© obrigat√≥rio";break;case"street":if(S&&!f.trim())return"Rua √© obrigat√≥ria";break;case"neighborhood":if(S&&!f.trim())return"Bairro √© obrigat√≥rio";break;case"city":if(S&&!f.trim())return"Cidade √© obrigat√≥ria";break;case"state":if(S&&!f.trim())return"Estado √© obrigat√≥rio";break}},R=(o,f)=>{let P=f;o==="cep"&&(P=ct(f),P!==r.cep&&(v(!1),k(!1),N(!1))),j($=>({...$,[o]:P})),l[o]&&C($=>({...$,[o]:void 0}))},A=o=>{_(P=>({...P,[o]:!0}));const f=u(o,r[o]);C(P=>({...P,[o]:f}))};c.useEffect(()=>{const o=r.cep.replace(/\D/g,"");o.length===8&&!p&&!E&&!h&&(x(!0),lt(o).then(f=>{x(!1),f?f.logradouro&&f.logradouro.trim()?(j(P=>({...P,street:f.logradouro||"",neighborhood:f.bairro||"",city:f.localidade||"",state:f.uf||""})),v(!0),k(!1),N(!1),C(P=>({...P,cep:void 0}))):f.localidade&&f.uf?(j(P=>({...P,street:"",neighborhood:f.bairro||"",city:f.localidade||"",state:f.uf||""})),v(!1),k(!1),N(!0),C(P=>({...P,cep:void 0}))):(k(!0),v(!1),N(!1)):(k(!0),v(!1),N(!1))}))},[r.cep,p,E,h]);const J=()=>{j(o=>({...o,cep:"",street:"",neighborhood:"",city:"",state:""})),v(!1),k(!1),N(!1),setTimeout(()=>{var o;return(o=V.current)==null?void 0:o.focus()},100)},z=be(r.cep)&&(p||S&&r.street.trim()&&r.neighborhood.trim()&&r.city.trim()&&r.state.trim())&&r.number.trim().length>0&&r.recipient.trim().length>0,O=o=>{o.preventDefault();const f=["cep","number","recipient"];let P=!0;const $={};f.forEach(H=>{const T=u(H,r[H]);T&&($[H]=T,P=!1)}),!p&&!E&&!h&&($.cep="CEP n√£o encontrado",P=!1),S&&(r.street.trim()||($.street="Rua √© obrigat√≥ria",P=!1),r.neighborhood.trim()||($.neighborhood="Bairro √© obrigat√≥rio",P=!1),r.city.trim()||($.city="Cidade √© obrigat√≥ria",P=!1),r.state.trim()||($.state="Estado √© obrigat√≥rio",P=!1)),C($),_({cep:!0,number:!0,recipient:!0,street:!0,neighborhood:!0,city:!0,state:!0}),P&&(a(r.shippingMethod),n({recipient:r.recipient,cep:r.cep,street:r.street,number:r.number,complement:r.complement,neighborhood:r.neighborhood,city:r.city,state:r.state}),d(s,t,"endereco"),m())};return e.jsxs("div",{className:"max-w-lg mx-auto space-y-5",children:[e.jsxs("div",{className:"text-left space-y-1",children:[e.jsx("h1",{className:"text-base font-semibold text-foreground",children:"Entrega"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Para onde enviamos seu pedido?"})]}),e.jsxs("form",{onSubmit:O,className:"space-y-5",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"relative",children:[e.jsx(Q,{ref:V,id:"cep",type:"text",inputMode:"numeric",placeholder:" ",value:r.cep,onChange:o=>R("cep",o.target.value),onBlur:()=>A("cep"),maxLength:9,className:y("h-14 px-4 pr-10 pt-5 pb-2 text-base rounded-xl border bg-card peer transition-all shadow-sm",g.cep&&l.cep?"border-destructive":"border-muted-foreground/20 focus-visible:border-primary")}),e.jsx("label",{htmlFor:"cep",className:y("absolute left-4 transition-all duration-200 pointer-events-none text-base","peer-placeholder-shown:top-1/2 peer-placeholder-shown:-translate-y-1/2 peer-placeholder-shown:text-base","peer-focus:top-2 peer-focus:-translate-y-0 peer-focus:text-xs",r.cep?"top-2 -translate-y-0 text-xs":"",g.cep&&l.cep?"text-destructive":"text-muted-foreground"),children:"CEP"}),w&&e.jsx("div",{className:"absolute right-4 top-1/2 -translate-y-1/2",children:e.jsx(Re,{className:"w-4 h-4 text-muted-foreground animate-spin"})}),p&&!w&&e.jsx("div",{className:"absolute right-4 top-1/2 -translate-y-1/2",children:e.jsx(U,{className:"w-4 h-4 text-accent"})})]}),g.cep&&l.cep&&!E&&e.jsx("p",{className:"text-destructive text-xs pl-1",children:l.cep}),E&&e.jsx("p",{className:"text-destructive text-xs pl-1",children:"Ops! N√£o achamos o endere√ßo. Preencha os campos abaixo pra continuar."}),h&&!E&&e.jsx("p",{className:"text-amber-600 text-xs pl-1",children:"CEP gen√©rico. Complete os dados do endere√ßo abaixo."}),!E&&!h&&e.jsxs("a",{href:"https://buscacepinter.correios.com.br/app/endereco/index.php",target:"_blank",rel:"noopener noreferrer",className:"inline-flex items-center gap-0.5 text-accent text-xs hover:underline",children:["N√£o sei meu CEP",e.jsx(ce,{className:"w-3 h-3"})]})]}),S&&e.jsxs("div",{className:"space-y-4 animate-fade-in",children:[e.jsx(Y,{id:"street",label:"Rua / Avenida",value:r.street,onChange:o=>R("street",o),onBlur:()=>A("street"),error:l.street,touched:g.street,isValid:r.street.trim().length>0}),e.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[e.jsx(Y,{id:"number",label:"N√∫mero",inputMode:"numeric",value:r.number,onChange:o=>R("number",o),onBlur:()=>A("number"),error:l.number,touched:g.number,isValid:r.number.trim().length>0}),e.jsx(Y,{id:"complement",label:"Complemento",value:r.complement,onChange:o=>R("complement",o),onBlur:()=>{},optional:!0,isValid:!0})]}),e.jsx(Y,{id:"neighborhood",label:"Bairro",value:r.neighborhood,onChange:o=>R("neighborhood",o),onBlur:()=>A("neighborhood"),error:l.neighborhood,touched:g.neighborhood,isValid:r.neighborhood.trim().length>0}),e.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[e.jsx(Y,{id:"city",label:"Cidade",value:r.city,onChange:o=>R("city",o),onBlur:()=>A("city"),error:l.city,touched:g.city,isValid:r.city.trim().length>0}),e.jsxs("div",{className:"space-y-1",children:[e.jsxs(Se,{value:r.state,onValueChange:o=>R("state",o),children:[e.jsx(Ie,{className:y("h-14 px-4 text-base rounded-xl border bg-card shadow-sm",g.state&&l.state?"border-destructive":"border-muted-foreground/20 focus:border-primary"),children:e.jsx(Ee,{placeholder:"Estado"})}),e.jsx(ke,{className:"bg-card border border-muted-foreground/20 z-50",children:dt.map(o=>e.jsx(_e,{value:o,children:o},o))})]}),g.state&&l.state&&e.jsx("p",{className:"text-destructive text-xs pl-1",children:l.state})]})]}),e.jsx(Y,{id:"recipient",label:"Quem vai receber?",value:r.recipient,onChange:o=>R("recipient",o),onBlur:()=>A("recipient"),error:l.recipient,touched:g.recipient,isValid:r.recipient.trim().length>0}),e.jsxs("div",{className:"space-y-3",children:[e.jsx("h3",{className:"text-base font-medium text-foreground",children:"Escolha a entrega"}),e.jsxs("button",{type:"button",onClick:()=>j(o=>({...o,shippingMethod:"normal"})),className:y("w-full flex items-center justify-between p-4 rounded-xl border transition-all text-left",r.shippingMethod==="normal"?"border-accent bg-accent/5":"border-muted-foreground/20 hover:border-muted-foreground/40"),children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-base font-medium text-foreground",children:"PAC"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:Z.normal.estimatedDays})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("span",{className:y("text-base font-bold","text-accent"),children:"Gr√°tis"}),e.jsx("div",{className:y("w-5 h-5 rounded-full border-2 flex items-center justify-center transition-all",r.shippingMethod==="normal"?"border-accent bg-accent":"border-muted-foreground/40"),children:r.shippingMethod==="normal"&&e.jsx(U,{className:"w-3 h-3 text-accent-foreground"})})]})]}),e.jsxs("button",{type:"button",onClick:()=>j(o=>({...o,shippingMethod:"express"})),className:y("w-full flex items-center justify-between p-4 rounded-xl border transition-all text-left",r.shippingMethod==="express"?"border-accent bg-accent/5":"border-muted-foreground/20 hover:border-muted-foreground/40"),children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-base font-medium text-foreground",children:"SEDEX"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:Z.express.estimatedDays})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("span",{className:"text-base font-bold text-foreground",children:X(Z.express.cost)}),e.jsx("div",{className:y("w-5 h-5 rounded-full border-2 flex items-center justify-center transition-all",r.shippingMethod==="express"?"border-accent bg-accent":"border-muted-foreground/40"),children:r.shippingMethod==="express"&&e.jsx(U,{className:"w-3 h-3 text-accent-foreground"})})]})]})]})]}),p&&e.jsxs("div",{className:"space-y-5 animate-fade-in",children:[e.jsx("div",{className:"bg-accent/10 border border-accent/30 rounded-xl p-4",children:e.jsxs("div",{className:"flex items-start justify-between gap-2",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-base font-medium text-foreground",children:r.street}),e.jsxs("p",{className:"text-sm text-muted-foreground",children:[r.neighborhood,", ",r.city," - ",r.state]})]}),e.jsx("button",{type:"button",onClick:J,className:"text-accent text-sm hover:underline flex-shrink-0",children:"Alterar"})]})}),e.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[e.jsx(Y,{id:"number",label:"N√∫mero",inputMode:"numeric",value:r.number,onChange:o=>R("number",o),onBlur:()=>A("number"),error:l.number,touched:g.number,isValid:r.number.trim().length>0}),e.jsx(Y,{id:"complement",label:"Complemento",value:r.complement,onChange:o=>R("complement",o),onBlur:()=>{},optional:!0,isValid:!0})]}),e.jsx(Y,{id:"recipient",label:"Quem vai receber?",value:r.recipient,onChange:o=>R("recipient",o),onBlur:()=>A("recipient"),error:l.recipient,touched:g.recipient,isValid:r.recipient.trim().length>0}),e.jsxs("div",{className:"space-y-3",children:[e.jsx("h3",{className:"text-base font-medium text-foreground",children:"Escolha a entrega"}),e.jsxs("button",{type:"button",onClick:()=>j(o=>({...o,shippingMethod:"normal"})),className:y("w-full flex items-center justify-between p-4 rounded-xl border transition-all text-left",r.shippingMethod==="normal"?"border-accent bg-accent/5":"border-muted-foreground/20 hover:border-muted-foreground/40"),children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-base font-medium text-foreground",children:"PAC"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:Z.normal.estimatedDays})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("span",{className:y("text-base font-bold","text-accent"),children:"Gr√°tis"}),e.jsx("div",{className:y("w-5 h-5 rounded-full border-2 flex items-center justify-center transition-all",r.shippingMethod==="normal"?"border-accent bg-accent":"border-muted-foreground/40"),children:r.shippingMethod==="normal"&&e.jsx(U,{className:"w-3 h-3 text-accent-foreground"})})]})]}),e.jsxs("button",{type:"button",onClick:()=>j(o=>({...o,shippingMethod:"express"})),className:y("w-full flex items-center justify-between p-4 rounded-xl border transition-all text-left",r.shippingMethod==="express"?"border-accent bg-accent/5":"border-muted-foreground/20 hover:border-muted-foreground/40"),children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-base font-medium text-foreground",children:"SEDEX"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:Z.express.estimatedDays})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("span",{className:"text-base font-bold text-foreground",children:X(Z.express.cost)}),e.jsx("div",{className:y("w-5 h-5 rounded-full border-2 flex items-center justify-center transition-all",r.shippingMethod==="express"?"border-accent bg-accent":"border-muted-foreground/40"),children:r.shippingMethod==="express"&&e.jsx(U,{className:"w-3 h-3 text-accent-foreground"})})]})]})]})]}),e.jsxs(te,{type:"submit",disabled:!z,className:y("w-full h-14 mt-3 font-semibold rounded-full text-base flex items-center justify-center gap-2 transition-all",z?"bg-[#141414] hover:bg-[#2a2a2a] text-white shadow-md":"bg-muted text-muted-foreground"),children:["Continuar",e.jsx(ce,{className:"w-5 h-5"})]}),e.jsx("p",{className:"text-xs text-muted-foreground text-center pt-2",children:"Entrega garantida em todo o Brasil"})]})]})},gt=()=>{const s=Date.now().toString(36),t=Math.random().toString(36).substring(2,8);return`ORD-${s}-${t}`.toUpperCase()},ft=(s,t,n,i,a,m)=>({id:gt(),customer:s,address:t,items:n.map(d=>({productId:d.product.id,name:d.product.name,price:d.product.price,originalPrice:d.product.originalPrice,quantity:d.quantity,image:d.product.image})),shipping:i,paymentMethod:a,totals:m,status:"pending",createdAt:new Date,updatedAt:new Date}),bt=()=>{const s=sessionStorage.getItem("utm_params"),t=s?JSON.parse(s):{},n=new URLSearchParams(window.location.search);return{utm_source:n.get("utm_source")||t.utm_source||null,utm_medium:n.get("utm_medium")||t.utm_medium||null,utm_campaign:n.get("utm_campaign")||t.utm_campaign||null,utm_content:n.get("utm_content")||t.utm_content||null,utm_term:n.get("utm_term")||t.utm_term||null}},jt=(s,t)=>{const n=(t==null?void 0:t.totalWithInterest)||Math.round(s.totals.total*100),i=s.paymentMethod==="credit_card"?"credit_card":"pix";return{orderId:s.id,amount:n,currency:"BRL",paymentMethod:i,customer:{name:`${s.customer.firstName} ${s.customer.lastName}`.trim(),email:s.customer.email,document:s.customer.cpf.replace(/\D/g,""),phone:s.customer.phone.replace(/\D/g,"")},billingAddress:{street:s.address.street,number:s.address.number,complement:s.address.complement||void 0,neighborhood:s.address.neighborhood,city:s.address.city,state:s.address.state,zipCode:s.address.cep.replace(/\D/g,""),country:"BR"},items:s.items.map(a=>({id:a.productId,name:a.name,quantity:a.quantity,unitPrice:Math.round(a.price*100)})),cardData:t?{number:t.number,holderName:t.holderName,expiryMonth:t.expiryMonth,expiryYear:t.expiryYear,cvv:t.cvv,installments:t.installments,totalWithInterest:t.totalWithInterest,cardBrand:t.cardBrand,cardLastDigits:t.cardLastDigits}:void 0,metadata:{source:"farmrio-checkout",version:"1.0.0"},utmParams:bt()}},Nt=async s=>{console.log("üì§ Enviando para Edge Function:",s);try{const{data:t,error:n}=await D.functions.invoke("process-payment",{body:s});return console.log("üì• Resposta da Edge Function:",{data:t,error:n}),n?(console.error("‚ùå Erro na Edge Function:",n),{success:!1,errorMessage:(t==null?void 0:t.error)||n.message||"Erro ao processar pagamento",transactionId:t==null?void 0:t.transactionId,status:t==null?void 0:t.status}):t.success?{success:!0,transactionId:t.transactionId,status:t.status,pixCode:t.pixCode,pixQrCode:t.pixQrCode,cardBrand:t.cardBrand,cardLastDigits:t.cardLastDigits}:{success:!1,errorMessage:t.error||"Erro no processamento do pagamento",transactionId:t.transactionId,status:t.status}}catch(t){return console.error("‚ùå Erro de conex√£o:",t),{success:!1,errorMessage:"Erro de conex√£o com o servidor de pagamento. Tente novamente."}}},we=s=>{const t=JSON.parse(localStorage.getItem("farmrio-orders")||"[]");t.push(s),localStorage.setItem("farmrio-orders",JSON.stringify(t))};async function vt(s){const t=s.number.replace(/\D/g,"");let n=s.expiryYear;n.length===2&&(n=`20${n}`);const i=parseInt(s.expiryMonth,10),a=parseInt(n,10);return t.length<13||t.length>19?{success:!1,error:"N√∫mero do cart√£o inv√°lido"}:i<1||i>12?{success:!1,error:"M√™s de validade inv√°lido"}:a<2025||a>2066?{success:!1,error:"Ano de validade inv√°lido"}:s.cvv.length<3||s.cvv.length>4?{success:!1,error:"CVV inv√°lido"}:(console.log("üîê Dados do cart√£o validados para PayoutBR"),{success:!0,brand:yt(t),lastFourDigits:t.slice(-4),cardData:{number:t,holderName:s.holderName.toUpperCase(),expiryMonth:s.expiryMonth.padStart(2,"0"),expiryYear:n,cvv:s.cvv}})}function yt(s){const t=s.replace(/\D/g,"");return/^4/.test(t)?"visa":/^5[1-5]/.test(t)||/^2[2-7]/.test(t)?"mastercard":/^3[47]/.test(t)?"amex":/^(636368|438935|504175|451416|636297|5067|4576|4011|506699|509|627780|636297|636368|650|6516|6550)/.test(t)?"elo":/^(606282|3841|384|60)/.test(t)?"hipercard":"unknown"}const ie="/assets/logo-vyron-white-WY6wnADs.png",$e=({pixCode:s,expirationMinutes:t=30,onConfirmPayment:n,orderId:i})=>{const[a,m]=c.useState(!1),[d,I]=c.useState(t*60),[r,j]=c.useState(!1),[l,C]=c.useState(null),[g,_]=c.useState(null),[w,x]=c.useState(!1),[p,v]=c.useState(null),h=c.useRef(null),N=c.useRef(null),{shippingCost:E,couponDiscount:k,customerData:V,addressData:S}=ee(),{totalPrice:u,items:R}=ae(),A=u*re/100,J=k?u*k/100:0,z=u+E-J-A,O=`https://api.qrserver.com/v1/create-qr-code/?size=200x200&data=${encodeURIComponent(s)}`;c.useEffect(()=>{window.scrollTo({top:0,behavior:"smooth"})},[]),c.useEffect(()=>{if(d<=0){j(!0);return}const b=setInterval(()=>{I(M=>M<=1?(j(!0),0):M-1)},1e3);return()=>clearInterval(b)},[d]);const o=async()=>{try{await navigator.clipboard.writeText(s),m(!0),W.success("C√≥digo PIX copiado!"),await D.from("transactions").update({pix_copied:!0}).eq("order_id",i),setTimeout(()=>m(!1),3e3)}catch{W.error("Erro ao copiar c√≥digo")}},f=["image/jpeg","image/png","image/gif","image/webp","image/heic","application/pdf","application/msword","application/vnd.openxmlformats-officedocument.wordprocessingml.document"],P=b=>b.startsWith("image/"),$=b=>{var B;const M=(B=b.target.files)==null?void 0:B[0];if(M){if(!f.includes(M.type)){W.error("Por favor, selecione uma imagem ou documento (PDF, DOC, DOCX)");return}if(M.size>10*1024*1024){W.error("O arquivo deve ter no m√°ximo 10MB");return}C(M),P(M.type)?_(URL.createObjectURL(M)):_(null)}},H=()=>{C(null),g&&(URL.revokeObjectURL(g),_(null)),N.current&&(N.current.value="")},T=async()=>{if(l){x(!0);try{const b=l.name.split(".").pop(),M=`${i}-${Date.now()}.${b}`,{data:B,error:F}=await D.storage.from("payment-receipts").upload(M,l);if(F)throw F;const{data:L}=D.storage.from("payment-receipts").getPublicUrl(M),K=L.publicUrl;await D.from("transactions").update({receipt_url:K,status:"paid",paid_at:new Date().toISOString()}).eq("order_id",i),v(K),W.success("Comprovante enviado! Pagamento confirmado.")}catch(b){console.error("Upload error:",b),W.error("Erro ao enviar comprovante")}finally{x(!1)}}},q=b=>new Intl.NumberFormat("pt-BR",{style:"currency",currency:"BRL"}).format(b),le=b=>{const M=Math.floor(b/60),B=b%60;return`${String(M).padStart(2,"0")}:${String(B).padStart(2,"0")}`};return r?e.jsx("div",{className:"min-h-screen bg-muted/30 flex flex-col items-center justify-center p-6",children:e.jsxs("div",{className:"bg-card rounded-xl p-6 max-w-sm w-full text-center shadow-sm border border-border",children:[e.jsx("div",{className:"w-16 h-16 rounded-full bg-destructive/10 flex items-center justify-center mx-auto mb-4",children:e.jsx("span",{className:"text-2xl",children:"‚è∞"})}),e.jsx("h3",{className:"text-lg font-semibold text-foreground mb-2",children:"PIX Expirado"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"O tempo para pagamento expirou. Por favor, realize uma nova compra."})]})}):e.jsxs("div",{className:"min-h-screen bg-muted/30",ref:h,children:[e.jsx("header",{className:"bg-[#141414] py-4",children:e.jsx("div",{className:"max-w-lg mx-auto px-4 flex justify-center",children:e.jsx(G,{to:"/colecao",children:e.jsx("img",{src:ie,alt:"Vyron",className:"h-10"})})})}),e.jsxs("main",{className:"max-w-lg mx-auto px-4 py-4 space-y-3",children:[e.jsxs("div",{className:"text-center space-y-1",children:[e.jsx("h1",{className:"text-base font-semibold text-foreground",children:"J√° √© quase seu..."}),e.jsxs("p",{className:"text-[10px] text-muted-foreground whitespace-nowrap",children:["Pague seu pix dentro de ",e.jsx("span",{className:"font-bold text-foreground",children:le(d)})," para garantir sua compra."]})]}),e.jsxs("div",{className:"bg-card rounded-lg border border-border p-3 flex flex-col items-center",children:[e.jsx("p",{className:"text-[10px] text-muted-foreground mb-2",children:"Aponte a c√¢mera do seu celular"}),e.jsx("div",{className:"bg-white p-1.5 rounded-md border border-border",children:e.jsx("img",{src:O,alt:"QR Code PIX",className:"w-28 h-28 object-contain"})})]}),e.jsx("div",{className:"flex items-center justify-center gap-2",children:e.jsxs("div",{className:"bg-amber-50 dark:bg-amber-900/20 border border-amber-200 dark:border-amber-800 rounded-full px-3 py-1.5 flex items-center gap-2",children:[e.jsx("span",{className:"text-xs font-medium text-amber-700 dark:text-amber-300",children:"Aguardando pagamento"}),e.jsxs("div",{className:"flex gap-0.5",children:[e.jsx("span",{className:"w-1 h-1 rounded-full bg-amber-500 animate-pulse"}),e.jsx("span",{className:"w-1 h-1 rounded-full bg-amber-500 animate-pulse [animation-delay:150ms]"}),e.jsx("span",{className:"w-1 h-1 rounded-full bg-amber-500 animate-pulse [animation-delay:300ms]"})]})]})}),e.jsx("button",{onClick:o,className:"w-full bg-card rounded-lg border border-border p-2 hover:border-accent transition-colors cursor-pointer group",children:e.jsx("p",{className:"text-[9px] text-muted-foreground text-center truncate px-1 font-mono group-hover:text-foreground transition-colors",children:s.length>50?`${s.substring(0,50)}...`:s})}),e.jsx("button",{onClick:o,className:y("w-full py-2.5 rounded-full font-semibold text-xs flex items-center justify-center gap-2 transition-all",a?"bg-[#141414] text-white":"bg-[#141414] text-white hover:bg-[#000000]"),children:a?e.jsxs(e.Fragment,{children:[e.jsx(U,{className:"w-3.5 h-3.5"}),"C√≥digo copiado!"]}):e.jsxs(e.Fragment,{children:[e.jsx(Je,{className:"w-3.5 h-3.5"}),"Copiar c√≥digo pix"]})}),e.jsxs("p",{className:"text-center text-xs text-muted-foreground",children:["Valor do Pix: ",e.jsx("span",{className:"font-bold text-foreground",children:q(z)})]}),e.jsxs("div",{className:"bg-card rounded-lg border border-border p-3 space-y-2",children:[e.jsx("h3",{className:"text-xs font-semibold text-foreground",children:"Como pagar o pix:"}),e.jsx("div",{className:"space-y-1.5",children:["Clique em copiar o c√≥digo PIX, logo acima","Acesse o app do seu banco","V√° at√© a op√ß√£o PIX",'Escolha a op√ß√£o "COPIA E COLA"',"Insira o c√≥digo copiado e finalize seu pagamento"].map((b,M)=>e.jsxs("div",{className:"flex items-start gap-2",children:[e.jsx("div",{className:"w-4 h-4 rounded-full bg-foreground text-background flex items-center justify-center flex-shrink-0 text-[8px] font-bold",children:M+1}),e.jsx("p",{className:"text-[10px] text-muted-foreground leading-relaxed",children:b})]},M))})]}),e.jsxs("div",{className:"bg-card rounded-lg border border-border p-3 space-y-2",children:[e.jsx("h3",{className:"text-xs font-semibold text-foreground",children:"Enviar comprovante de pagamento"}),e.jsx("p",{className:"text-[10px] text-muted-foreground",children:"Ap√≥s realizar o pagamento, envie o comprovante para agilizar a confirma√ß√£o do seu pedido."}),e.jsx("input",{ref:N,type:"file",accept:"image/*,.pdf,.doc,.docx,application/pdf,application/msword,application/vnd.openxmlformats-officedocument.wordprocessingml.document",onChange:$,className:"hidden"}),!l&&!p&&e.jsxs("button",{onClick:()=>{var b;return(b=N.current)==null?void 0:b.click()},className:"w-full py-2.5 border-2 border-dashed border-border rounded-lg hover:border-accent transition-colors flex flex-col items-center gap-1.5 group",children:[e.jsx("div",{className:"w-8 h-8 rounded-full bg-muted flex items-center justify-center group-hover:bg-accent/10 transition-colors",children:e.jsx(ge,{className:"w-4 h-4 text-muted-foreground group-hover:text-accent"})}),e.jsx("span",{className:"text-xs text-muted-foreground group-hover:text-foreground",children:"Clique para selecionar um arquivo"}),e.jsx("span",{className:"text-[10px] text-muted-foreground",children:"Imagens ou PDF at√© 10MB"})]}),l&&!p&&e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"relative rounded-md overflow-hidden border border-border",children:[g?e.jsx("img",{src:g,alt:"Preview do comprovante",className:"w-full h-28 object-cover"}):e.jsxs("div",{className:"w-full h-28 bg-muted flex flex-col items-center justify-center gap-1.5",children:[e.jsx(He,{className:"w-8 h-8 text-muted-foreground"}),e.jsx("span",{className:"text-xs text-muted-foreground truncate max-w-[80%]",children:l.name})]}),e.jsx("button",{onClick:H,className:"absolute top-1.5 right-1.5 w-6 h-6 bg-destructive text-destructive-foreground rounded-full flex items-center justify-center hover:bg-destructive/90 transition-colors",children:e.jsx(Be,{className:"w-3 h-3"})})]}),e.jsx("button",{onClick:T,disabled:w,className:"w-full py-2.5 rounded-full bg-accent text-accent-foreground font-semibold text-xs hover:bg-accent/90 transition-colors disabled:opacity-50 flex items-center justify-center gap-2",children:w?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"w-3.5 h-3.5 border-2 border-accent-foreground/30 border-t-accent-foreground rounded-full animate-spin"}),"Enviando..."]}):e.jsxs(e.Fragment,{children:[e.jsx(ge,{className:"w-3.5 h-3.5"}),"Enviar comprovante"]})})]}),p&&e.jsxs("div",{className:"space-y-1.5",children:[e.jsxs("div",{className:"flex items-center gap-2 p-2 bg-accent/10 rounded-md border border-accent/20",children:[e.jsx("div",{className:"w-6 h-6 rounded-full bg-accent flex items-center justify-center",children:e.jsx(U,{className:"w-3 h-3 text-accent-foreground"})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("p",{className:"text-xs font-medium text-foreground",children:"Comprovante enviado!"}),e.jsx("p",{className:"text-[10px] text-muted-foreground",children:"Aguarde a confirma√ß√£o do pagamento."})]})]}),e.jsxs("div",{className:"relative rounded-md overflow-hidden border border-border",children:[e.jsx("img",{src:p,alt:"Comprovante enviado",className:"w-full h-24 object-cover opacity-80"}),e.jsx("div",{className:"absolute inset-0 bg-foreground/5 flex items-center justify-center",children:e.jsx(Ze,{className:"w-5 h-5 text-muted-foreground"})})]})]})]}),e.jsxs("div",{className:"bg-card rounded-lg border border-border p-3 space-y-3",children:[e.jsxs("div",{className:"flex items-center gap-2 border-b border-border pb-2",children:[e.jsx("div",{className:"w-5 h-5 rounded-full bg-primary/10 flex items-center justify-center",children:e.jsx(Ae,{className:"w-3 h-3 text-primary"})}),e.jsx("h3",{className:"text-xs font-semibold text-foreground",children:"Dados do Pedido"}),e.jsxs("span",{className:"ml-auto text-[10px] text-muted-foreground font-mono",children:["#",i.slice(0,8)]})]}),e.jsxs("div",{className:"space-y-1.5",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Fe,{className:"w-3 h-3 text-muted-foreground flex-shrink-0"}),e.jsxs("span",{className:"text-[10px] text-foreground truncate",children:[V.firstName," ",V.lastName]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Me,{className:"w-3 h-3 text-muted-foreground flex-shrink-0"}),e.jsx("span",{className:"text-[10px] text-foreground truncate",children:V.email})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Ve,{className:"w-3 h-3 text-muted-foreground flex-shrink-0"}),e.jsx("span",{className:"text-[10px] text-foreground",children:V.phone})]}),e.jsxs("div",{className:"flex items-start gap-2",children:[e.jsx(Ke,{className:"w-3 h-3 text-muted-foreground flex-shrink-0 mt-0.5"}),e.jsxs("span",{className:"text-[10px] text-foreground leading-relaxed",children:[S.street,", ",S.number,S.complement&&` - ${S.complement}`,e.jsx("br",{}),S.neighborhood,", ",S.city," - ",S.state,e.jsx("br",{}),"CEP: ",S.cep]})]})]}),e.jsx("div",{className:"border-t border-dashed border-border"}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("p",{className:"text-[10px] font-medium text-muted-foreground uppercase tracking-wide",children:"Itens do Pedido"}),R.map((b,M)=>e.jsxs("div",{className:"flex items-center gap-2 bg-muted/30 rounded-md p-1.5",children:[e.jsx("img",{src:b.product.image,alt:b.product.name,className:"w-8 h-8 rounded object-cover"}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("p",{className:"text-[10px] font-medium text-foreground truncate",children:b.product.name}),e.jsxs("p",{className:"text-[9px] text-muted-foreground",children:["Tam: ",b.size," ‚Ä¢ Qtd: ",b.quantity]})]}),e.jsx("span",{className:"text-[10px] font-medium text-foreground",children:q(b.product.price*b.quantity)})]},M))]})]})]}),e.jsx(oe,{})]})},wt={1:0,2:20.99,3:22.02,4:23.89,5:25.4,6:26.5,7:27.5,8:29.5,9:30.5,10:32,11:33.5,12:37.49},Ct=s=>{const t=s.replace(/\s/g,"");return/^4/.test(t)?"visa":/^5[1-5]/.test(t)||/^2[2-7]/.test(t)?"mastercard":/^3[47]/.test(t)?"amex":/^(636368|438935|504175|451416|636297|5067|4576|4011|506699)/.test(t)?"elo":/^(606282|3841)/.test(t)?"hipercard":"unknown"},Pt=s=>{const t=s.replace(/\D/g,"").slice(0,16),n=t.match(/.{1,4}/g);return n?n.join(" "):t},St=s=>{const t=s.replace(/\D/g,"").slice(0,4);return t.length>=2?`${t.slice(0,2)}/${t.slice(2)}`:t},Ce={visa:"text-blue-600",mastercard:"text-orange-500",amex:"text-blue-500",elo:"text-yellow-500",hipercard:"text-red-500",unknown:"text-muted-foreground"},It={visa:"Visa",mastercard:"Mastercard",amex:"American Express",elo:"Elo",hipercard:"Hipercard",unknown:""},Et=({onCardDataChange:s,totalAmount:t})=>{const[n,i]=c.useState(""),[a,m]=c.useState(""),[d,I]=c.useState(""),[r,j]=c.useState(""),[l,C]=c.useState("1"),[g,_]=c.useState("unknown"),[w,x]=c.useState({});c.useEffect(()=>{const h=n.replace(/\s/g,"");_(Ct(h))},[n]);const v=(()=>{const h=[];for(let N=1;N<=12;N++){const E=wt[N],k=N===1?t:t*(1+E/100),V=k/N;let S;N===1?S=`1x de R$ ${V.toFixed(2).replace(".",",")} sem juros`:S=`${N}x de R$ ${V.toFixed(2).replace(".",",")}`,h.push({value:N.toString(),label:S,totalWithInterest:Math.round(k*100)})}return h})();return c.useEffect(()=>{const h=n.replace(/\s/g,""),[N,E]=d.split("/"),k=new Date,V=k.getFullYear(),S=k.getMonth()+1,u={};if(h&&h.length<13&&(u.number="N√∫mero inv√°lido"),a&&a.length<3&&(u.holderName="Nome muito curto"),d&&d.length===5){const o=Number.parseInt(N,10),f=Number.parseInt(E,10),P=Number.isInteger(f)?2e3+f:NaN;(!Number.isInteger(o)||o<1||o>12)&&(u.expiry="M√™s inv√°lido"),u.expiry||(Number.isInteger(f)?!Number.isInteger(P)||P<V||P>2066?u.expiry=`Ano inv√°lido (use ${String(V).slice(-2)} a 66)`:P===V&&o<S&&(u.expiry="Cart√£o vencido"):u.expiry="Ano inv√°lido")}r&&(r.length<3||r.length>4)&&(u.cvv="CVV inv√°lido"),x(u);const R=h.length>=13&&a.length>=3&&d.length===5&&r.length>=3&&Object.keys(u).length===0,A=v.find(o=>o.value===l),J=(A==null?void 0:A.totalWithInterest)||Math.round(t*100),z=Number.parseInt(E,10),O=Number.isInteger(z)?2e3+z:NaN;s({number:h,holderName:a,expiryMonth:N||"",expiryYear:Number.isInteger(O)?String(O):"",cvv:r,installments:parseInt(l),totalWithInterest:J},R)},[n,a,d,r,l,s,t]),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center gap-2 text-sm text-muted-foreground mb-4",children:[e.jsx(Te,{className:"w-4 h-4"}),e.jsx("span",{children:"Seus dados est√£o protegidos"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(se,{htmlFor:"cardNumber",children:"N√∫mero do cart√£o"}),e.jsxs("div",{className:"relative",children:[e.jsx(Q,{id:"cardNumber",type:"text",inputMode:"numeric",placeholder:"0000 0000 0000 0000",value:n,onChange:h=>i(Pt(h.target.value)),className:y("pr-20",w.number&&"border-destructive")}),e.jsxs("div",{className:"absolute right-3 top-1/2 -translate-y-1/2 flex items-center gap-2",children:[g!=="unknown"&&e.jsx("span",{className:y("text-xs font-medium",Ce[g]),children:It[g]}),e.jsx(xe,{className:y("w-5 h-5",Ce[g])})]})]}),w.number&&e.jsx("p",{className:"text-xs text-destructive",children:w.number})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(se,{htmlFor:"holderName",children:"Nome no cart√£o"}),e.jsx(Q,{id:"holderName",type:"text",placeholder:"Como est√° impresso no cart√£o",value:a,onChange:h=>m(h.target.value.toUpperCase()),className:y(w.holderName&&"border-destructive")}),w.holderName&&e.jsx("p",{className:"text-xs text-destructive",children:w.holderName})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(se,{htmlFor:"expiry",children:"Validade"}),e.jsx(Q,{id:"expiry",type:"text",inputMode:"numeric",placeholder:"MM/AA",value:d,onChange:h=>I(St(h.target.value)),className:y(w.expiry&&"border-destructive")}),w.expiry&&e.jsx("p",{className:"text-xs text-destructive",children:w.expiry})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(se,{htmlFor:"cvv",children:"CVV"}),e.jsx(Q,{id:"cvv",type:"text",inputMode:"numeric",placeholder:"000",value:r,onChange:h=>j(h.target.value.replace(/\D/g,"").slice(0,4)),className:y(w.cvv&&"border-destructive")}),w.cvv&&e.jsx("p",{className:"text-xs text-destructive",children:w.cvv})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(se,{htmlFor:"installments",children:"Parcelas"}),e.jsxs(Se,{value:l,onValueChange:C,children:[e.jsx(Ie,{children:e.jsx(Ee,{placeholder:"Selecione"})}),e.jsx(ke,{children:v.map(h=>e.jsx(_e,{value:h.value,children:h.label},h.value))})]})]})]})},kt="/assets/pix-icon-new-CtLg8YdW.png",_t=s=>{const t=s.toLowerCase();return t.includes("n√£o autoriza")||t.includes("recusad")?{title:"Cart√£o n√£o autorizado",message:"O banco n√£o autorizou esta transa√ß√£o. Verifique os dados ou tente outro cart√£o."}:t.includes("saldo")||t.includes("limite")?{title:"Saldo insuficiente",message:"Seu cart√£o n√£o possui limite dispon√≠vel para esta compra."}:t.includes("expirad")||t.includes("vencid")||t.includes("validade")?{title:"Cart√£o vencido",message:"Este cart√£o est√° expirado. Use outro cart√£o v√°lido."}:t.includes("cvv")||t.includes("c√≥digo de seguran√ßa")?{title:"C√≥digo de seguran√ßa inv√°lido",message:"O c√≥digo de seguran√ßa (CVV) est√° incorreto. Verifique e tente novamente."}:t.includes("n√∫mero")&&t.includes("inv√°lido")?{title:"N√∫mero do cart√£o inv√°lido",message:"O n√∫mero do cart√£o est√° incorreto. Verifique os dados e tente novamente."}:t.includes("bloqueado")?{title:"Cart√£o bloqueado",message:"Este cart√£o est√° bloqueado. Entre em contato com seu banco ou use outro cart√£o."}:t.includes("fraude")||t.includes("antifraud")?{title:"Transa√ß√£o n√£o permitida",message:"Esta transa√ß√£o foi bloqueada por seguran√ßa. Tente outro cart√£o."}:{title:"Erro no pagamento",message:s}},Mt=()=>{const[s,t]=c.useState(600);c.useEffect(()=>{const a=setInterval(()=>{t(m=>m>0?m-1:0)},1e3);return()=>clearInterval(a)},[]);const n=Math.floor(s/60),i=s%60;return s===0?null:e.jsxs("div",{className:"flex items-center justify-center gap-1.5 bg-amber-50 dark:bg-amber-900/20 border border-amber-200 dark:border-amber-800 rounded-lg px-3 py-2",children:[e.jsx(tt,{className:"w-3.5 h-3.5 text-amber-600 dark:text-amber-400"}),e.jsxs("span",{className:"text-xs font-medium text-amber-700 dark:text-amber-300",children:["Reservado por"," ",e.jsxs("span",{className:"font-bold tabular-nums",children:[String(n).padStart(2,"0"),":",String(i).padStart(2,"0")]})]})]})},Vt=({onComplete:s,onPixPaymentStart:t})=>{const{paymentMethod:n,setPaymentMethod:i,customerData:a,addressData:m,shippingOption:d,shippingCost:I,couponDiscount:r,setSummaryCollapsed:j}=ee(),{items:l,totalPrice:C,totalDiscount:g,clearCart:_,closeCart:w}=ae(),{saveAbandonedCart:x}=pe(),[p,v]=c.useState(!1),[h,N]=c.useState(null),[E,k]=c.useState(!1),[V,S]=c.useState(null),[u,R]=c.useState(null),[A,J]=c.useState(!1),z=c.useRef(null);c.useEffect(()=>{x(a,m,"pagamento"),window.scrollTo({top:0,behavior:"smooth"})},[]);const O=C*r/100,o=n==="pix"?C*re/100:0,f=C+I-O-o,P=async()=>{S(null),v(!0);try{let T;if(n==="credit_card"&&u){console.log("üîê Validando dados do cart√£o...");const F=await vt({number:u.number,holderName:u.holderName,expiryMonth:u.expiryMonth,expiryYear:u.expiryYear,cvv:u.cvv});if(!F.success||!F.cardData){const L=F.error||"Erro ao processar cart√£o. Tente novamente ou use PIX.";S(L),W.error("Erro no cart√£o",{description:L}),v(!1);return}T={number:F.cardData.number,holderName:F.cardData.holderName,expiryMonth:F.cardData.expiryMonth,expiryYear:F.cardData.expiryYear,cvv:F.cardData.cvv,installments:u.installments,totalWithInterest:u.totalWithInterest,cardBrand:F.brand,cardLastDigits:F.lastFourDigits},console.log("‚úÖ Dados do cart√£o validados com sucesso")}const q=n==="credit_card"&&T?T.totalWithInterest/100:f,le={subtotal:C,shipping:I,discount:g,couponDiscount:O,total:q},b=ft(a,m,l,{option:d,cost:I,estimatedDays:Z[d].estimatedDays},n,le),M=jt(b,T),B=await Nt(M);if(B.success){const F=Pe();Oe({orderId:b.id,totalValue:f,productIds:l.map(L=>L.product.id),totalItems:l.reduce((L,K)=>L+K.quantity,0)},F),Ue({orderId:b.id,totalValue:f,productIds:l.map(L=>L.product.id),totalItems:l.reduce((L,K)=>L+K.quantity,0)},F,{email:a.email,phone:a.phone,firstName:a.firstName,lastName:a.lastName,externalId:b.id,city:m.city,state:m.state,zipCode:m.cep,country:"br"}),B.pixCode?(w(),j(!0),we({...b,status:"pending"}),t?t(B.pixCode,b.id):(N({pixCode:B.pixCode,orderId:b.id}),k(!0))):(we({...b,status:"paid"}),_(),s(b.id))}else{const F=B.errorMessage||"Erro ao processar pagamento";S(F),W.error("Erro no pagamento",{description:F})}}catch(T){const q=T instanceof Error?T.message:"Erro ao processar pedido";S(q),W.error("Erro no pagamento",{description:q})}finally{v(!1)}},$=()=>{h&&(_(),s(h.orderId))},H=n==="pix"||n==="credit_card"&&A;return E&&h?e.jsx($e,{pixCode:h.pixCode,orderId:h.orderId,onConfirmPayment:$}):e.jsxs("div",{ref:z,className:"space-y-4",children:[e.jsx(Mt,{}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("button",{type:"button",onClick:()=>i("pix"),className:y("w-full relative flex items-center p-4 rounded-xl border transition-all",n==="pix"?"border-gray-900 bg-gray-100 ring-1 ring-gray-900":"border-border hover:border-gray-400"),children:[e.jsxs("div",{className:"flex items-center gap-3 flex-1",children:[e.jsx("img",{src:kt,alt:"PIX",className:"h-6"}),e.jsxs("div",{className:"text-left flex items-center gap-2",children:[e.jsx("span",{className:"font-semibold text-sm",children:"PIX"}),e.jsxs("span",{className:"text-xs text-green-600 font-medium bg-green-100 dark:bg-green-900/30 px-1.5 py-0.5 rounded",children:[re,"% OFF"]})]})]}),e.jsx("div",{className:y("w-5 h-5 rounded-full border-2 flex items-center justify-center",n==="pix"?"border-gray-900":"border-muted-foreground/30"),children:n==="pix"&&e.jsx("div",{className:"w-2.5 h-2.5 rounded-full bg-gray-900"})})]}),e.jsxs("button",{type:"button",onClick:()=>i("credit_card"),className:y("w-full relative flex items-center p-4 rounded-xl border transition-all",n==="credit_card"?"border-gray-900 bg-gray-100 ring-1 ring-gray-900":"border-border hover:border-gray-400"),children:[e.jsxs("div",{className:"flex items-center gap-3 flex-1",children:[e.jsx(xe,{className:"h-6 w-6 text-muted-foreground"}),e.jsx("span",{className:"font-semibold text-sm",children:"Cart√£o de Cr√©dito"})]}),e.jsx("div",{className:y("w-5 h-5 rounded-full border-2 flex items-center justify-center",n==="credit_card"?"border-gray-900":"border-muted-foreground/30"),children:n==="credit_card"&&e.jsx("div",{className:"w-2.5 h-2.5 rounded-full bg-gray-900"})})]})]}),n==="pix"&&e.jsx("div",{className:"bg-accent/5 border border-accent/20 rounded-lg p-3",children:e.jsx("p",{className:"text-xs text-muted-foreground",children:'Ap√≥s clicar em "Finalizar compra" voc√™ ter√° 30 minutos para pagar com Pix usando QR Code ou c√≥digo que ser√° exibido. A confirma√ß√£o √© instant√¢nea.'})}),n==="credit_card"&&e.jsx(Et,{totalAmount:C+I-O,onCardDataChange:(T,q)=>{R(T),J(q)}}),V&&(()=>{const{title:T,message:q}=_t(V);return e.jsxs("div",{className:"bg-destructive/10 border border-destructive/30 rounded-lg p-3 flex items-start gap-2",children:[e.jsx(rt,{className:"w-4 h-4 text-destructive flex-shrink-0 mt-0.5"}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-destructive text-xs",children:T}),e.jsx("p",{className:"text-[10px] text-muted-foreground mt-0.5",children:q})]})]})})(),e.jsx(te,{type:"button",onClick:P,disabled:p||!H,className:"w-full h-12 bg-[#141414] hover:bg-[#2a2a2a] text-white font-semibold rounded-full text-sm flex items-center justify-center gap-2 shadow-md disabled:bg-muted disabled:text-muted-foreground",children:p?e.jsxs(e.Fragment,{children:[e.jsx(Re,{className:"w-4 h-4 animate-spin"}),n==="pix"?"Gerando seu PIX... aguarde":"Processando pagamento..."]}):e.jsxs(e.Fragment,{children:["Finalizar compra",e.jsx(ce,{className:"w-4 h-4"})]})}),e.jsx("p",{className:"text-[10px] text-muted-foreground text-center pt-1",children:"Compra 100% segura ‚Ä¢ Dados protegidos"})]})},Ft=({onComplete:s,onPixPaymentStart:t})=>e.jsx("div",{className:"w-full lg:max-w-lg lg:mx-auto",children:e.jsx(Vt,{onComplete:s,onPixPaymentStart:t})}),Rt=({orderId:s})=>e.jsx("div",{className:"min-h-[60vh] flex items-center justify-center",children:e.jsxs("div",{className:"text-center max-w-md mx-auto px-4",children:[e.jsx("div",{className:"w-20 h-20 mx-auto mb-6 rounded-full bg-primary/10 flex items-center justify-center",children:e.jsx(at,{className:"w-12 h-12 text-primary"})}),e.jsx("h1",{className:"text-2xl font-bold text-foreground mb-2",children:"Pedido realizado com sucesso!"}),e.jsx("p",{className:"text-muted-foreground mb-6",children:"Obrigado pela sua compra. Voc√™ receber√° um e-mail com os detalhes do pedido."}),e.jsxs("div",{className:"bg-muted/50 rounded-lg p-4 mb-8",children:[e.jsxs("div",{className:"flex items-center justify-center gap-2 mb-2",children:[e.jsx(Ae,{className:"w-5 h-5 text-primary"}),e.jsx("span",{className:"text-sm font-medium text-muted-foreground",children:"N√∫mero do pedido"})]}),e.jsx("p",{className:"text-lg font-bold text-foreground font-mono",children:s})]}),e.jsx(G,{to:"/",children:e.jsxs(te,{className:"w-full h-12 bg-primary hover:bg-primary/90 text-primary-foreground font-semibold",children:["Voltar para a loja",e.jsx(ze,{className:"w-5 h-5 ml-2"})]})}),e.jsx(G,{to:"/colecao",className:"block mt-4 text-sm text-primary hover:underline",children:"Continuar comprando"})]})}),At=()=>{const{items:s,totalItems:t,totalPrice:n,clearCart:i}=ae(),{currentStep:a,prevStep:m}=ee(),[d,I]=c.useState(null),[r,j]=c.useState(null),l=c.useRef(!1);c.useEffect(()=>{if(s.length>0&&!l.current){const w=Pe();Ye({totalValue:n,totalItems:t,productIds:s.map(x=>x.product.id)},w),We({totalValue:n,totalItems:t,productIds:s.map(x=>x.product.id)},w),l.current=!0}},[s,n,t]);const C=(w,x)=>{j({pixCode:w,orderId:x})},g=()=>{r&&(i(),I(r.orderId),j(null))};if(r)return e.jsx($e,{pixCode:r.pixCode,orderId:r.orderId,onConfirmPayment:g});if(d)return e.jsxs("div",{className:"min-h-screen bg-muted/30",children:[e.jsx("header",{className:"bg-[#000000] border-b border-gray-200",children:e.jsx("div",{className:"max-w-6xl mx-auto px-4 py-4 flex items-center justify-center",children:e.jsx(G,{to:"/",children:e.jsx("img",{src:ie,alt:"Vyron",className:"h-6 sm:h-8"})})})}),e.jsx("main",{className:"py-8",children:e.jsx(Rt,{orderId:d})}),e.jsx(oe,{})]});if(s.length===0)return e.jsxs("div",{className:"min-h-screen bg-muted/30",children:[e.jsx("header",{className:"bg-[#000000] border-b border-gray-200",children:e.jsx("div",{className:"max-w-6xl mx-auto px-4 py-4 flex items-center justify-center",children:e.jsx(G,{to:"/",children:e.jsx("img",{src:ie,alt:"Vyron",className:"h-6 sm:h-8"})})})}),e.jsx("main",{className:"py-16",children:e.jsxs("div",{className:"text-center max-w-md mx-auto px-4",children:[e.jsx("div",{className:"w-20 h-20 mx-auto mb-6 rounded-full bg-muted flex items-center justify-center",children:e.jsx(nt,{className:"w-10 h-10 text-muted-foreground"})}),e.jsx("h1",{className:"text-2xl font-bold text-foreground mb-2",children:"Seu carrinho est√° vazio"}),e.jsx("p",{className:"text-muted-foreground mb-6",children:"Adicione produtos ao carrinho para continuar com a compra."}),e.jsx(G,{to:"/colecao",children:e.jsxs(te,{className:"w-full h-12 bg-primary hover:bg-primary/90 text-primary-foreground font-semibold",children:[e.jsx(Xe,{className:"w-5 h-5 mr-2"}),"Voltar para produtos"]})})]})}),e.jsx(oe,{})]});const _=()=>{switch(a){case 1:return e.jsx(ye,{});case 2:return e.jsx(ht,{});case 3:return e.jsx(Ft,{onComplete:I,onPixPaymentStart:C});default:return e.jsx(ye,{})}};return e.jsxs("div",{className:"min-h-screen bg-muted/30",children:[e.jsxs("header",{className:"bg-[#000000] border-b border-gray-200 sticky top-0 z-50",children:[e.jsxs("div",{className:"max-w-6xl mx-auto px-4 py-3 flex items-center justify-between",children:[a>1?e.jsxs("button",{onClick:m,className:"flex items-center gap-1 text-gray-300 hover:text-white transition-colors",children:[e.jsx(fe,{className:"w-4 h-4"}),e.jsx("span",{className:"text-xs",children:"Voltar"})]}):e.jsxs(G,{to:"/",className:"flex items-center gap-1 text-gray-300 hover:text-white transition-colors",children:[e.jsx(fe,{className:"w-4 h-4"}),e.jsx("span",{className:"text-xs",children:"Loja"})]}),e.jsx(G,{to:"/",children:e.jsx("img",{src:ie,alt:"Vyron",className:"h-5"})}),e.jsx("div",{className:"w-12"})]}),e.jsx(ut,{currentStep:a})]}),e.jsxs("main",{className:"max-w-6xl mx-auto px-4 py-2 lg:py-4",children:[e.jsx("div",{className:"lg:hidden mb-4",children:e.jsx(je,{isMobile:!0})}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-[1fr_380px] gap-0 lg:gap-6",children:[e.jsx("div",{className:"order-1",children:_()}),e.jsx("div",{className:"order-1 lg:order-2 hidden lg:block",children:e.jsx("div",{className:"sticky top-36",children:e.jsx(je,{})})})]})]}),e.jsx(oe,{})]})},Zt=()=>e.jsx(At,{});export{Zt as default};
